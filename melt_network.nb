(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16825,        393]
NotebookOptionsPosition[     15462,        362]
NotebookOutlinePosition[     15918,        380]
CellTagsIndexPosition[     15875,        377]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Visualization", "Section",
 CellChangeTimes->{{3.871121614720423*^9, 3.871121619206708*^9}, {
  3.871121650577718*^9, 
  3.8711216653899794`*^9}},ExpressionUUID->"65a1106b-b68d-4c1d-9e11-\
6527ccbf438b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"theEdgeInCoords", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Green", ",", 
       RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"thepoints", "\[LeftDoubleBracket]", 
           RowBox[{
           "skelLine", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            "\[RightDoubleBracket]"}], ",", 
          RowBox[{"thepoints", "\[LeftDoubleBracket]", 
           RowBox[{
           "skelLine", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
            "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"skelLine", ",", "thelines"}], "}"}]}], "]"}]}], ";"}]], "Code",\

 CellChangeTimes->{{3.8711217197694592`*^9, 3.871121741474017*^9}, {
  3.8711245463117723`*^9, 3.871124550110768*^9}, {3.8711246307012224`*^9, 
  3.871124672866871*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"0dfc00ba-6fa9-49fb-949d-decf634f765f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"theBasicBalls", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "0.5", "]"}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{"False", ",", 
         RowBox[{"degreeColor", "[", 
          RowBox[{"theJ", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", " ", "2"}], "\[RightDoubleBracket]"}], "]"}], 
         ",", "Brown"}], "]"}], ",", " ", 
       RowBox[{"Ball", "[", 
        RowBox[{
         RowBox[{"theJ", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"theJ", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "5"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "theJ", "]"}], "\[LeftDoubleBracket]", "1",
         "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.8711217197694592`*^9, 3.8711217639036655`*^9}, {
   3.8711229193303003`*^9, 3.8711229229685097`*^9}, 3.8711233961428223`*^9, 
   3.871159629896633*^9, {3.87191362620538*^9, 3.871913659160715*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"6f1eaeee-2920-43ad-a60f-57f9891c5943"],

Cell[BoxData[
 RowBox[{
  RowBox[{"theMergedBalls", ":=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"theJuncHistory", ",", "iter"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"colorByDegree", "=", "False"}], ";", "\n", "\t", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Opacity", "[", "0.5", "]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{"colorByDegree", ",", 
            RowBox[{"degreeColor", "[", 
             RowBox[{"theJuncHistory", "\[LeftDoubleBracket]", 
              RowBox[{"iter", ",", "1", ",", "i", ",", "2"}], 
              "\[RightDoubleBracket]"}], "]"}], ",", " ", "Blue"}], "]"}], 
          ",", " ", 
          RowBox[{"Ball", "[", 
           RowBox[{
            RowBox[{"theJuncHistory", "\[LeftDoubleBracket]", 
             RowBox[{"iter", ",", "1", ",", "i", ",", "4"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"theJuncHistory", "\[LeftDoubleBracket]", 
             RowBox[{"iter", ",", "1", ",", "i", ",", "5"}], 
             "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{"theJuncHistory", "\[LeftDoubleBracket]", 
             RowBox[{"iter", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "}"}]}], 
       "]"}]}]}], "\n", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.8711217197694592`*^9, 3.8711217639036655`*^9}, {
   3.8711229193303003`*^9, 3.8711229229685097`*^9}, 3.8711233961428223`*^9, {
   3.871159629896633*^9, 3.8711596490789223`*^9}, {3.8711597229632373`*^9, 
   3.871159723264432*^9}, 3.8714173485127707`*^9, 3.871912647495245*^9, {
   3.871913174243938*^9, 3.871913212264698*^9}, {3.871913246385344*^9, 
   3.8719133318458757`*^9}, {3.871913362662277*^9, 3.871913369100507*^9}, {
   3.87191352663216*^9, 3.871913566104987*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"f02e0708-a4e9-410e-8f31-7e9bb052548f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"theMergingPair", ":=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"theJuncHistory", ",", "iter"}], "}"}], ",", "\n", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "1", "]"}], ",", " ", "Red", ",", " ", 
         RowBox[{"Ball", "[", 
          RowBox[{
           RowBox[{"theJuncHistory", "\[LeftDoubleBracket]", 
            RowBox[{"iter", ",", "2", ",", "k", ",", "4"}], 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"theJuncHistory", "\[LeftDoubleBracket]", 
            RowBox[{"iter", ",", "2", ",", "k", ",", "5"}], 
            "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "2"}], "}"}]}], "]"}]}], "\n", "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.8711217197694592`*^9, 3.8711217639036655`*^9}, {
   3.8711229193303003`*^9, 3.8711229229685097`*^9}, 3.8711233961428223`*^9, {
   3.871159629896633*^9, 3.8711596490789223`*^9}, {3.8711597229632373`*^9, 
   3.871159723264432*^9}, 3.8714173485127707`*^9, {3.871912647495245*^9, 
   3.871912674519328*^9}, {3.871912792337326*^9, 3.871912806977683*^9}, {
   3.871912958737597*^9, 3.871912987522316*^9}, 3.8719134590214777`*^9},
 CellLabel->
  "In[147]:=",ExpressionUUID->"26bbdf61-7a6f-4a56-b059-4018eaff74ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\n", "\t", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"showEdges", ",", "theEdgeInCoords"}], "]"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{"showBasicBalls", ",", "theBasicBalls"}], "]"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{"showMergedBalls", ",", 
         RowBox[{"theMergedBalls", "[", 
          RowBox[{"theJuncHistory", ",", "iter"}], "]"}]}], "]"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{"showMergingPair", ",", 
         RowBox[{"theMergingPair", "[", 
          RowBox[{"theJuncHistory", ",", "iter"}], "]"}]}], "]"}]}], "\n", 
      "\t\t", "}"}], "]"}], "\n", "\t", "]"}], ",", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{"showEdges", ",", " ", 
     RowBox[{"{", 
      RowBox[{"True", ",", " ", "False"}], "}"}]}], "}"}], ",", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{"showBasicBalls", ",", " ", 
     RowBox[{"{", 
      RowBox[{"True", ",", " ", "False"}], "}"}]}], "}"}], ",", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{"showMergedBalls", ",", " ", 
     RowBox[{"{", 
      RowBox[{"True", ",", " ", "False"}], "}"}]}], "}"}], ",", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{"showMergingPair", ",", " ", 
     RowBox[{"{", 
      RowBox[{"True", ",", " ", "False"}], "}"}]}], "}"}], ",", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{"iter", ",", "1", ",", 
     RowBox[{"Length", "[", "theJuncHistory", "]"}], ",", "1"}], "}"}]}], 
  "\n", "]"}]], "Code",
 CellChangeTimes->{{3.8711217197694592`*^9, 3.871121764717284*^9}, 
   3.871122996348056*^9, {3.871124216643141*^9, 3.8711244532471356`*^9}, {
   3.871124704394879*^9, 3.871124714009343*^9}, {3.8711251942207465`*^9, 
   3.871125203938037*^9}, {3.871125525962989*^9, 3.871125544506791*^9}, {
   3.8711596663790383`*^9, 3.871159705490453*^9}, {3.8714173903719482`*^9, 
   3.871417405174819*^9}, {3.871420085797806*^9, 3.871420116571488*^9}, {
   3.8719120214870567`*^9, 3.8719120586348543`*^9}, {3.871912097605475*^9, 
   3.8719121016677113`*^9}, 3.871912643690133*^9, {3.871912677388136*^9, 
   3.87191269756938*^9}, {3.871912731164526*^9, 3.871912733890297*^9}, {
   3.871912811972413*^9, 3.871912820420804*^9}, 3.871913407400923*^9, 
   3.8719141358473797`*^9},ExpressionUUID->"46a572ee-0212-4235-8547-\
c71dff1d8026"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`iter$$ = 
    138, $CellContext`showBasicBalls$$ = True, $CellContext`showEdges$$ = 
    True, $CellContext`showMergedBalls$$ = 
    True, $CellContext`showMergingPair$$ = True, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`showEdges$$], {True, False}}, {
      Hold[$CellContext`showBasicBalls$$], {True, False}}, {
      Hold[$CellContext`showMergedBalls$$], {True, False}}, {
      Hold[$CellContext`showMergingPair$$], {True, False}}, {
      Hold[$CellContext`iter$$], 1, 181, 1}}, Typeset`size$$ = {
    812., {401., 410.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`iter$$ = 1, $CellContext`showBasicBalls$$ = 
        True, $CellContext`showEdges$$ = True, $CellContext`showMergedBalls$$ = 
        True, $CellContext`showMergingPair$$ = True}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        Graphics3D[{
          If[$CellContext`showEdges$$, $CellContext`theEdgeInCoords], 
          If[$CellContext`showBasicBalls$$, $CellContext`theBasicBalls], 
          If[$CellContext`showMergedBalls$$, 
           $CellContext`theMergedBalls[$CellContext`theJuncHistory, \
$CellContext`iter$$]], 
          If[$CellContext`showMergingPair$$, 
           $CellContext`theMergingPair[$CellContext`theJuncHistory, \
$CellContext`iter$$]]}]], 
      "Specifications" :> {{$CellContext`showEdges$$, {
         True, False}}, {$CellContext`showBasicBalls$$, {
         True, False}}, {$CellContext`showMergedBalls$$, {
         True, False}}, {$CellContext`showMergingPair$$, {
         True, False}}, {$CellContext`iter$$, 1, 181, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{886., {540., 550.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.871912108994649*^9, 3.8719121253012667`*^9}, {
   3.871912699445709*^9, 3.871912734737543*^9}, {3.871913028316*^9, 
   3.871913039574641*^9}, 3.8719134089025373`*^9, {3.871913443307391*^9, 
   3.871913465261796*^9}, {3.8719136702886543`*^9, 3.8719137003337927`*^9}, {
   3.871913744587173*^9, 3.87191375399339*^9}, {3.871913869093276*^9, 
   3.871913879563365*^9}, {3.8719139255226507`*^9, 3.87191393310963*^9}, {
   3.8719140255565023`*^9, 3.8719140592701187`*^9}},
 CellLabel->
  "Out[152]=",ExpressionUUID->"e095bacf-6cfd-4e1f-a9f5-f132cf5195af"]
}, Open  ]],

Cell["\<\
Important merging iteration:
138\
\>", "Text",
 CellChangeTimes->{{3.871914377683069*^9, 3.8719143788981447`*^9}, {
  3.871914427268956*^9, 3.87191443825318*^9}, {3.8719144766879253`*^9, 
  3.871914476911859*^9}},ExpressionUUID->"11a36489-358d-40ad-92bc-\
0af0732e4d8e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Histogram", "[", 
    RowBox[{"theJuncHistory", "\[LeftDoubleBracket]", 
     RowBox[{"iter", ",", "1", ",", ";;", ",", "2"}], 
     "\[RightDoubleBracket]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"iter", ",", "1", ",", 
     RowBox[{"Length", "[", "theJuncHistory", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Code",
 CellChangeTimes->{{3.871125096120226*^9, 3.87112512402203*^9}, {
  3.871125509478692*^9, 3.871125514247528*^9}, {3.8711257211624126`*^9, 
  3.8711257411589975`*^9}, {3.8711599012982187`*^9, 3.871159906721037*^9}, {
  3.871904837326075*^9, 3.8719048482374563`*^9}, {3.871904883361806*^9, 
  3.871904921452525*^9}, {3.871914117243052*^9, 3.871914163651988*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"b47c499c-4e4e-479e-a05e-bd34d1018709"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`iter$$ = 181, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`iter$$], 1, 181, 1}}, Typeset`size$$ = {
    612., {187., 195.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`iter$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Histogram[
        Part[$CellContext`theJuncHistory, $CellContext`iter$$, 1, 
         Span[1, All], 2]], 
      "Specifications" :> {{$CellContext`iter$$, 1, 181, 1}}, "Options" :> {},
       "DefaultOptions" :> {}],
     ImageSizeCache->{686., {278., 287.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8711257424018655`*^9, 3.871159908436013*^9, 3.871161995505251*^9, 
   3.871166998862237*^9, 3.8714201361693153`*^9, {3.871420522245779*^9, 
   3.8714205414892883`*^9}, 3.871904765482629*^9, {3.8719048884576263`*^9, 
   3.871904921930735*^9}, 3.871914168566153*^9, 3.871914206795768*^9},
 CellLabel->
  "Out[153]=",ExpressionUUID->"7523825a-8847-45fb-a98c-f2fbd531cf5f"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{Automatic, 1912}, {141, Automatic}},
Magnification:>1.7 Inherited,
Background->GrayLevel[1],
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2271a160-4ff0-4bd3-b570-df24a6bcb528"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 209, 4, 114, "Section",ExpressionUUID->"65a1106b-b68d-4c1d-9e11-6527ccbf438b"],
Cell[792, 28, 1053, 25, 108, "Code",ExpressionUUID->"0dfc00ba-6fa9-49fb-949d-decf634f765f"],
Cell[1848, 55, 1271, 30, 108, "Code",ExpressionUUID->"6f1eaeee-2920-43ad-a60f-57f9891c5943"],
Cell[3122, 87, 2116, 45, 208, "Code",ExpressionUUID->"f02e0708-a4e9-410e-8f31-7e9bb052548f"],
Cell[5241, 134, 1384, 30, 175, "Code",ExpressionUUID->"26bbdf61-7a6f-4a56-b059-4018eaff74ac"],
Cell[CellGroupData[{
Cell[6650, 168, 2454, 54, 519, "Code",ExpressionUUID->"46a572ee-0212-4235-8547-c71dff1d8026"],
Cell[9107, 224, 3255, 62, 1140, "Output",ExpressionUUID->"e095bacf-6cfd-4e1f-a9f5-f132cf5195af"]
}, Open  ]],
Cell[12377, 289, 280, 7, 98, "Text",ExpressionUUID->"11a36489-358d-40ad-92bc-0af0732e4d8e"],
Cell[CellGroupData[{
Cell[12682, 300, 828, 17, 108, "Code",ExpressionUUID->"b47c499c-4e4e-479e-a05e-bd34d1018709"],
Cell[13513, 319, 1921, 39, 615, "Output",ExpressionUUID->"7523825a-8847-45fb-a98c-f2fbd531cf5f"]
}, Open  ]]
}, Open  ]]
}
]
*)

